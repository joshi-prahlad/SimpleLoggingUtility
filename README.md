# SimpleLoggingUtility
Problem Statement
Create a logging utility that can be used to send the logged statements to console or to 

a logfile or to both.

The log routine should be of the form:

void DMLog(DMLogLevel logLevel, char *format, ...);

Where the Log levels will be:

typedef enum

{

DM_LOG_ERROR,

DM_LOG_WARNING,

DM_LOG_TRACE,

DM_LOG_INFO

}DMLogLevel;

Example : Usage of the utility.

-----------

      int state;

      char errorDetail[]="Bad State";

      DMLog(DM_LOG_INFO, "This is just an informative message");

      state = 2;

      DMLog(DM_LOG_WARNING, "In an unexpected State: %d", state);

      state = 3;

      DMLog(DM_LOG_ERROR, "This is bad State: %d, Detail: %s", state, errorDetail);

------------

Example Output : The above code snippet should produce the following output in both 

console and/or file.

<DM_LOG_INFO>         :This is just an informative message

<DM_LOG_WARNING>:In an unexpected State: 2

<DM_LOG_ERROR>     :This is bad State: 3, Detail: Bad State

The utility should be usable in a multi threaded environment, where multiple threads can 

be calling into the logging routine. The logging utility should have the least possible 

overhead so as to minimize any performance impact due to logging on the calling 

threads.

While it is not necessary that the logged messages appear in the console or log file 

immediately, it is desirable that if the log level is DM_LOG_EROR, the message show 

up in the output as soon as possible.

It is not necessary to maintain log ordering between multiple threads, but logs from a 

single thread should appear at the output in the same order as the call to the log utility.

Apple Confidential Code Assignment

In addition to correctly performing the logging, the utility should be able to take 

advantage of multi-core or multi-processor machines, in addition you are encouraged to 

take advantage of any other hardware specific considerations to make your utility 

efficient.

All configurable or tunable parameters should be specified in a configuration header file 

with descriptive comments on its meaning and performance tradeoff if any.

Example :

#define LOG_TO_FILE     1             /* 1 = Log to File, 0 = Donot Log to File */

#define LOG_TO_CONSOLE 0      /* 1 = Log to Console, 0 = Donot log to Console */

#define DM_NUM_CORES    2       /* Number of Cores in this system */

All error and/or status information from the utility should be printed on stderr.

The utility should be written in C or C++ and should build on a UNIX platform. Please 

make sure that your submission compiles and runs correctly with a variety of different 

inputs. Finally, keep in mind that you will be evaluated not only on the correctness of 

your solution, but also the organization and efficiency of your code.

Solution

  Logger is the main class which is implemented as a singleton and has DMLog method.
  In its constructor it sets up the FileWriter to the log file (which is created in 
  the current directory with the name "errorLog"). Also, a thread pool of DM_NUM_CORES 
  threads is created, each with a associated thread safe queue and the same FileWriter instance.
  Each LoggerThread is 
  responsible for handling one queue. It polls the queue for a message and stores the log
  message in its cache and flushes the cache to console/log file when either the cache is
  full or we see a DMLogError message. When a thread calls DMLog method for the first time
  we create a mapping from that thread to one of the work queues and all the log messages 
  generated by that thread is inserted in the associated queue. So all the message generated
  by one thread always ends up in the same queue while a queue might have messages 
  generated from multiple threads. Caching log messages avoids writing to disks too frequently
  and having a thread pool allows multiple threads to use logging facility concurrently.
  FileWriter is appropriately protected from multiple thread access with synchronized keyword
  and ConcurrentLinkedQueue is used to allow multiple threads to safely insert in the 
  message queue.
  
